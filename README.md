# 화재 및 외벽 오염 감지 시스템 개발 로드맵

## 프로젝트 개요

### 프로젝트 목표
도로 CCTV를 활용한 화재/연기 감지 및 건물 외벽 오염 인식 시스템 개발

### 기술 스택
- 모델: YOLOv5s (HEAD 튜닝)
- 태스크: Object Detection (분리 모델 방식)
- 데이터: RGB 도로 CCTV 영상
- 하드웨어: NVIDIA Jetson Nano/Orin
- 경량화: Quantization (FP32 → FP16 → INT8) + TensorRT

### 정량 목표
- 외벽 오염 인식 정확도: mAP 70% 이상 (목표: 75%)
- 화재/연기 감지 정확도: Recall 80% 이상 (목표: 85%)
- 속도 향상: Jetson 기반 영상 분석 30초 이내
- CCTV 연동 분석 성공률: 90% 이상
- 관리자용 리포트 자동 생성률: 100%
- 사용자 인터페이스 사용성 만족도: 평균 80점 이상

## 개발 로드맵 (총 6개월)

### Phase 1: 화재 모델 개발 (1-3개월)

#### Month 1: 데이터 수집 및 환경 구축

**Week 1-2: 화재 데이터 수집**
- 목표: 3,000장 화재/연기 이미지
- YouTube 화재 영상 프레임 추출: 2,000장
- 직접 촬영 (라이터, 양초, 모닥불): 500장
- 온라인 화재 이미지 수집: 500장

클래스 구성:
- Fire: 1,500장 (불꽃, 화염)
- Smoke: 1,500장 (흰연기, 검은연기)

**Week 3-4: 개발 환경 구축**
- 서버 환경 설정 (RTX 5090 2장)
- PyTorch, YOLOv5 Ultralytics 설치
- 데이터 전처리 파이프라인 구축
- Train/Val/Test 분할 (70:20:10)

#### Month 2: 화재 모델 학습 및 최적화

**Week 1-2: YOLOv5s HEAD 튜닝**
- 기본 모델 로드: YOLOv5s(pretrained=True)
- Backbone 및 Neck 고정 (requires_grad = False)
- HEAD만 화재 특화 튜닝 (requires_grad = True)
- 목표 성능: mAP@0.5 85%, Recall 85%

**Week 3-4: 경량화 1단계**
- FP32 → FP16 변환
- 성능 검증 및 비교
- 핸드폰 테스트 준비 (모바일 포맷 변환)

#### Month 3: 화재 모델 완성 및 검증

**Week 1-2: 핸드폰 테스트**
- PyTorch Mobile 앱 개발
- 실제 화재 상황 테스트 (안전한 환경)
  - 라이터, 양초, 바베큐 등
  - 다양한 거리 (1m, 5m, 10m)
  - 다양한 조명 (실내, 실외, 야간)
- 성능 검증 및 데이터 보완

**Week 3-4: INT8 양자화 및 최적화**
- FP16 → INT8 변환
- 성능 손실 3% 이내 확인
- TensorRT 엔진 생성 (Jetson 준비)

### Phase 2: 외벽 모델 및 통합 시스템 (4-6개월)

#### Month 4: 외벽 데이터 수집 및 모델 학습

**Week 1-2: 외벽 오염 데이터 수집**
- 목표: 3,000장 외벽 손상 이미지
- 건물 촬영 (균열, 얼룩, 부식): 2,000장
- 온라인 건축 손상 이미지: 1,000장

클래스 구성:
- Crack: 1,000장 (벽 균열)
- Stain: 1,000장 (얼룩, 변색)
- Rust: 1,000장 (철재 부식)

**Week 3-4: 외벽 모델 학습**
- YOLOv5s 기반 외벽 특화 HEAD 설계
- 화재 모델과 동일한 튜닝 방식 적용
- 목표 성능: mAP@0.5 75% (목표 70% 초과)

#### Month 5: 외벽 모델 최적화 및 시스템 통합

**Week 1-2: 외벽 모델 경량화**
- 화재 모델과 동일한 경량화 프로세스
- FP32 → FP16 → INT8 단계적 적용
- TensorRT 엔진 생성

**Week 3-4: 통합 시스템 구축**
- 두 모델 통합 실행 시스템 개발
- 이중 모델 동시 처리 최적화
- 결과 통합 알고리즘 구현

#### Month 6: 최종 배포 및 검증

**Week 1-2: Jetson 배포**
- Jetson Nano/Orin에 모델 배포
- 실시간 성능 테스트
  - 목표: 15FPS (Nano), 30FPS (Orin)
- CCTV RTSP 스트림 연동 테스트

**Week 3-4: 최종 시스템 완성**
- 관리자용 리포트 자동 생성 시스템
- UI/UX 개발 및 사용성 테스트
- 정량 목표 최종 검증

## 데이터 수집 상세 가이드

### 화재/연기 데이터 수집

#### 1. YouTube 영상 수집
검색 키워드:
- "building fire", "car fire", "house fire"
- "smoke detection", "fire accident", "fire CCTV"
- "도로 화재", "건물 화재", "차량 화재"

프레임 추출 방법:
- 30프레임마다 1장 추출 (1초 간격)
- 해상도: 최소 640x640 이상
- 다양한 화재 단계 포함 (초기, 성장기, 최성기)

#### 2. 직접 촬영 (안전한 환경)
실내 촬영:
- 라이터 불꽃 (다양한 각도)
- 양초, 가스레인지 (일상적 화재)
- 종이 태우기 (소형 연기)

실외 촬영:
- 바베큐, 캠프파이어 (통제된 불)
- 낙엽 태우기 (자연 연기)
- 담배 연기 (소형 연기)

주의사항: 안전 확보, 필요시 소방서 사전 신고

#### 3. 온라인 이미지 수집
무료 이미지 소스:
- Unsplash.com (고품질 무료 이미지)
- Pexels.com (CC0 라이선스)
- Pixabay.com (무료 스톡)
- Kaggle Datasets (Fire detection 데이터셋)

기존 공개 데이터셋:
- FireNet Dataset
- BoWFire Dataset
- Corsican Fire Dataset

### 외벽 오염 데이터 수집

#### 1. 직접 촬영 (권장)
도심 건물 외벽:
- 아파트, 오피스빌딩 외벽
- 다양한 시간대 (조명 조건 변화)
- 다양한 각도 (정면, 측면, 아래에서 위로)

손상 유형별:
- 균열: 콘크리트 균열, 타일 갈라짐
- 얼룩: 물때, 곰팡이, 변색
- 부식: 철재 녹, 페인트 벗겨짐

촬영 사양:
- 해상도: 1080p 이상
- 거리: 5-50m (CCTV 거리 시뮬레이션)
- 계절별 촬영 (날씨 조건 다양화)

#### 2. 온라인 수집
- 건설 안전 사이트
- 건물 진단 업체 사례
- 보험사 손상 사례
- Google Street View (건물 외벽 이미지)

## 라벨링 상세 가이드

### 도구 및 환경
- 주 도구: LabelImg (가장 직관적)
- 대안 도구: Roboflow (온라인 협업 가능)

작업 분담:
- AI 전문가: 품질 관리 및 어려운 케이스
- 주니어 A: 화재 데이터 라벨링
- 주니어 B: 외벽 데이터 라벨링

### 화재 라벨링 가이드라인

#### Fire 클래스 라벨링 기준
포함할 것:
- 주황/빨강 불꽃
- 가스 불꽃 (파란색도 포함)
- 타오르는 물체
- 명확한 화염

제외할 것:
- 햇빛 반사
- 가로등, LED 조명
- 자동차 헤드라이트
- 노을, 석양

Bounding Box 그리기 팁:
- 여백: 불꽃 경계에서 10% 여유 공간
- 모양: 불꽃 전체를 포함하는 최소 사각형
- 겹침: 여러 불꽃이 있으면 각각 별도 박스

#### Smoke 클래스 라벨링 기준
포함할 것:
- 흰색/회색 연기
- 검은 연기
- 희미한 연기도 포함
- 연기 기둥 전체

제외할 것:
- 구름
- 안개, 물안개
- 자동차 배기가스
- 수증기 (목욕탕 등)

### 외벽 라벨링 가이드라인

#### Crack 클래스 라벨링
포함할 것:
- 벽면 균열 (선 형태)
- 타일 갈라짐
- 콘크리트 크랙
- 1mm 이상 눈에 보이는 균열

라벨링 팁:
- 균열 선을 따라 긴 직사각형
- 여러 균열은 각각 별도 박스
- 너무 작은 균열은 제외

#### Stain 클래스 라벨링
포함할 것:
- 물때 얼룩
- 곰팡이 (검은 점들)
- 페인트 벗겨짐
- 변색 부위

라벨링 팁:
- 얼룩 전체 영역 포함
- 경계가 모호해도 대략적으로
- 색상 변화가 명확한 부분만

#### Rust 클래스 라벨링
포함할 것:
- 철재 녹 (갈색/주황색)
- 금속 부식
- 볼트, 난간 녹
- 철근 노출 및 녹

### 라벨링 프로세스

#### 1. 주니어 교육 (1주일)
- Day 1-2: LabelImg 사용법 교육
- Day 3-4: 샘플 100장 함께 라벨링
- Day 5: 독립 라벨링 후 검토

#### 2. 품질 관리 시스템
- 1차 라벨링: 주니어가 전체 작업
- 2차 검토: AI 전문가가 20% 샘플 체크
- 3차 수정: 문제 발견 시 재라벨링
- 최종 검증: 10% holdout 데이터로 성능 테스트

#### 3. 라벨링 속도 목표
숙련도별 속도:
- 초급 (1-2주차): 1분/장 (60장/일)
- 중급 (3-4주차): 30초/장 (120장/일)
- 고급 (1개월 후): 20초/장 (180장/일)

월별 목표:
- Month 1: 주니어A 1,500장 (화재)
- Month 4: 주니어B 1,500장 (외벽)

## 기술적 구현 상세

### HEAD 튜닝 방법
```python
# YOLOv5s Pre-trained 모델 로드
model = YOLOv5s(pretrained=True)

# Backbone 및 Neck 고정
model.backbone.requires_grad = False
model.neck.requires_grad = False

# HEAD만 도메인 특화 튜닝
model.head.requires_grad = True
train_head_only(model, domain_specific_data)
```

### 경량화 프로세스
1. FP32 → FP16 변환
   - 메모리 사용량 50% 감소
   - 추론 속도 1.5-2배 향상
   - 성능 손실 거의 없음

2. FP16 → INT8 양자화
   - 메모리 사용량 75% 감소
   - 추론 속도 2-4배 향상
   - 성능 손실 2-3% 이내

3. TensorRT 최적화
   - NVIDIA Jetson 전용 최적화
   - 추가 1.5-2배 속도 향상
   - GPU 메모리 효율성 개선

### 분리 모델 아키텍처
```python
class DualDetectionSystem:
    def __init__(self):
        self.fire_model = load_fire_trt_engine()
        self.wall_model = load_wall_trt_engine()
    
    def process_image(self, image):
        fire_result = self.fire_model(image)
        wall_result = self.wall_model(image)
        return combine_results(fire_result, wall_result)
```

## 예상 성능 및 리스크 분석

### 성공 확률
- 화재 모델: 95% (검증된 방법론)
- 외벽 모델: 90% (새로운 도메인이지만 단순)
- 통합 시스템: 85% (시스템 통합 리스크)

### 예상 성능
화재 모델:
- Recall: 85-90% (목표 80% 초과)
- Precision: 88-93%
- 추론 속도: Jetson Nano 15FPS, Orin 30FPS

외벽 모델:
- mAP@0.5: 75-80% (목표 70% 초과)
- Precision: 85-90%
- 추론 속도: 화재 모델과 동일

### 백업 계획
화재 모델이 목표 미달 시:
- 데이터 추가 수집 (1,000장)
- Data Augmentation 적극 활용
- Loss Function 최적화 (Focal Loss 등)

외벽 모델이 목표 미달 시:
- Transfer Learning 활용 (건축 관련 pre-trained)
- 클래스 단순화 (3개 → 2개)
- 어려운 케이스 데이터 추가 수집

## 개발 환경 및 리소스

### 하드웨어
- 학습 서버: RTX 5090 2장
- 개발 환경: MacBook (SSH 원격 접속)
- 배포 환경: NVIDIA Jetson Nano/Orin
- 테스트 환경: 스마트폰 (중간 검증용)

### 소프트웨어
- 딥러닝 프레임워크: PyTorch
- 객체 감지: YOLOv5 Ultralytics
- 라벨링 도구: LabelImg
- 최적화: TensorRT, torch.quantization
- 버전 관리: Git

### 인력 구성
- AI 전문가 1명: 아키텍처 설계, 모델 최적화
- 주니어 개발자 2명: 데이터 수집, 라벨링, 테스트

## 성과물

### 기술적 성과물
1. 화재/연기 감지 경량화 모델
2. 외벽 오염 인식 경량화 모델
3. Jetson 기반 실시간 추론 시스템
4. 통합 CCTV 분석 소프트웨어

### 연구 성과
1. YOLOv5 기반 HEAD 특화 튜닝 방법론
2. 도로 CCTV 환경 특화 데이터셋
3. 경량화 효과 정량 분석 결과
4. 실시간 멀티 도메인 감지 시스템

## 위험 요소 및 대응 방안

### 주요 위험 요소
1. 데이터 품질 문제: 라벨링 정확도 저하
2. 성능 목표 미달: 경량화 과정에서 정확도 손실
3. 하드웨어 호환성: Jetson 배포 시 예상치 못한 이슈
4. 일정 지연: 예상보다 복잡한 구현

### 대응 방안
1. 단계별 검증: 각 월말 성능 점검
2. 백업 계획: 목표 미달 시 대안 전략
3. 조기 테스트: 핸드폰 테스트로 사전 검증
4. 점진적 개발: 복잡도 단계적 증가

## 결론

본 프로젝트는 YOLOv5s 기반 HEAD 튜닝과 경량화 기법을 통해 도로 CCTV 환경에서 화재 감지 및 외벽 오염 인식이 가능한 실시간 시스템을 개발한다. 6개월 개발 기간 동안 단계적이고 검증된 접근 방식을 통해 정량 목표 달성을 보장하며, 실용적인 엣지 AI 솔루션을 제공할 것으로 기대된다.